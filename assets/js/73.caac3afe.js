(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{461:function(a,t,e){"use strict";e.r(t);var s=e(8),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"immudb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#immudb"}},[a._v("#")]),a._v(" immudb")]),a._v(" "),t("h2",{attrs:{id:"contents-0-8-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#contents-0-8-1"}},[a._v("#")]),a._v(" Contents 0.8.1")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#latest-binaries"}},[a._v("Latest binaries")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#build"}},[a._v("Build")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#docker"}},[a._v("Docker")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#run-immudb"}},[a._v("Run immudb")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#configuration"}},[a._v("Configuration")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#immuadmin"}},[a._v("immuadmin")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#immudb-service"}},[a._v("immudb service")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#authentication"}},[a._v("Authentication")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#backup-and-restore"}},[a._v("Backup and Restore")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#multi-database"}},[a._v("Multi-Database")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#clients"}},[a._v("Clients")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#auditors"}},[a._v("Auditors")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#architecture"}},[a._v("Architecture")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#consistency-checker"}},[a._v("Consistency Checker")])]),a._v(" "),t("li",[t("a",{attrs:{href:"#license"}},[a._v("License")])])]),a._v(" "),t("h2",{attrs:{id:"latest-binaries"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#latest-binaries"}},[a._v("#")]),a._v(" Latest binaries")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/codenotary/immudb/releases/latest",target:"_blank",rel:"noopener noreferrer"}},[a._v("Get the latest builds"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("If you run macOS you can also use Homebrew:")]),a._v(" "),t("p",[t("code",[a._v("brew install immudb")])]),a._v(" "),t("h2",{attrs:{id:"build"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[a._v("#")]),a._v(" Build")]),a._v(" "),t("p",[a._v("clone the immudb repository locally")]),a._v(" "),t("p",[a._v("'git clone https://github.com/codenotary/immudb.git'")]),a._v(" "),t("h3",{attrs:{id:"linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux"}},[a._v("#")]),a._v(" Linux")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" immudb-static\n")])])]),t("h3",{attrs:{id:"macos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#macos"}},[a._v("#")]),a._v(" MacOS")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("darwin "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" immudb-static\n")])])]),t("h3",{attrs:{id:"windows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[a._v("#")]),a._v(" Windows")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("windows "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" immudb-static\n")])])]),t("h2",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[a._v("#")]),a._v(" Docker")]),a._v(" "),t("h3",{attrs:{id:"build-your-own-docker-container-image"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build-your-own-docker-container-image"}},[a._v("#")]),a._v(" build your own Docker container image")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" myown/immudb:latest "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" Dockerfile "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),t("h3",{attrs:{id:"run-immugw-in-a-container"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run-immugw-in-a-container"}},[a._v("#")]),a._v(" run immugw in a container")]),a._v(" "),t("p",[a._v("Make sure to point to the immudb system using the environment variable IMMUGW_IMMUDB_ADDRESS")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3322")]),a._v(":3322 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9497")]),a._v(":9497 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" immudb codenotary/immugw:latest\n")])])]),t("p",[a._v("or listen on all interfaces")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3322")]),a._v(":3322 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9497")]),a._v(":9497 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" immudb "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_ADDRESS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0"')]),a._v(" codenotary/immudb\n")])])]),t("p",[a._v("listen on all interfaces, persistent data")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" volume create immudb-data\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3322")]),a._v(":3322 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9497")]),a._v(":9497 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" immudb-data:/var/lib/immudb "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" immudb "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_ADDRESS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0"')]),a._v(" codenotary/immudb\n")])])]),t("h2",{attrs:{id:"run-immudb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run-immudb"}},[a._v("#")]),a._v(" Run immudb")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# run immudb in the foreground")]),a._v("\n./immudb\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# run immudb in the background")]),a._v("\n./immudb "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("\n")])])]),t("h2",{attrs:{id:"configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[a._v("#")]),a._v(" Configuration")]),a._v(" "),t("p",[a._v("immudb can be configured using environment variables, flags or a config file.")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("immudb --help")]),a._v(" shows you all available flags and environment variables.")]),a._v(" "),t("li",[t("code",[a._v("/etc/immudb/immudb.toml")]),a._v(" is used as a default configuration file")])]),a._v(" "),t("h3",{attrs:{id:"environment-variables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#environment-variables"}},[a._v("#")]),a._v(" Environment variables")]),a._v(" "),t("p",[a._v("The environment variables are the most popular way to configure Docker container:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_DIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(".\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_NETWORK")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tcp\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_ADDRESS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),a._v(".0.0\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_PORT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3322")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_DBNAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("immudb\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_PIDFILE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_LOGFILE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_MTLS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_AUTH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_DETACHED")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_CONSISTENCY_CHECK")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_PKEY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./tools/mtls/3_application/private/localhost.key.pem\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_CERTIFICATE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./tools/mtls/3_application/certs/localhost.cert.pem\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_CLIENTCAS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./tools/mtls/2_intermediate/certs/ca-chain.cert.pem\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_DEVMODE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_MAINTENANCE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("IMMUDB_ADMIN_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("immudb\n\n")])])]),t("h2",{attrs:{id:"immuadmin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#immuadmin"}},[a._v("#")]),a._v(" immuadmin")]),a._v(" "),t("p",[a._v("immuadmin can be used to install and manage the immudb service for Windows and Linux")]),a._v(" "),t("h3",{attrs:{id:"linux-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-2"}},[a._v("#")]),a._v(" Linux")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" immuadmin-static\n")])])]),t("h3",{attrs:{id:"windows-by-component"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-by-component"}},[a._v("#")]),a._v(" Windows (by component)")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("windows "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" immuadmin-static\n")])])]),t("h2",{attrs:{id:"immudb-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#immudb-service"}},[a._v("#")]),a._v(" immudb service")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# install immudb service")]),a._v("\n./immudb "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# check current immudb service status")]),a._v("\n./immudb "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" status\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# stop immudb service")]),a._v("\n./immudb "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" stop\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# start immudb service")]),a._v("\n./immudb "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" start\n")])])]),t("p",[a._v("The linux service is using the following defaults:")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("File or configuration")]),a._v(" "),t("th",[a._v("location")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("all configuration files")]),a._v(" "),t("td",[a._v("/etc/immudb")])]),a._v(" "),t("tr",[t("td",[a._v("all data files")]),a._v(" "),t("td",[a._v("/var/lib/immudb")])]),a._v(" "),t("tr",[t("td",[a._v("pid file")]),a._v(" "),t("td",[a._v("/var/lib/immudb/immudb.pid")])]),a._v(" "),t("tr",[t("td",[a._v("log files")]),a._v(" "),t("td",[a._v("/var/log/immudb")])])])]),a._v(" "),t("h2",{attrs:{id:"authentication"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[a._v("#")]),a._v(" Authentication")]),a._v(" "),t("p",[a._v("immudb supports multiple user accounts that can have admin, read-only or read-write permission.\nAll permissions are stored in a different database and each gRPC call has an associated minimum permissions.")]),a._v(" "),t("p",[a._v("To enable authentication you need to change the configuration file "),t("code",[a._v("/etc/immudb/immudb.toml")])]),a._v(" "),t("p",[a._v("Example:")]),a._v(" "),t("div",{staticClass:"language-toml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-toml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/lib/immudb"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("network")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tcp"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("address")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3322")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("dbname")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"data"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("pidfile")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/lib/immudb/immudb.pid"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("logfile")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/var/log/immudb/immudb.log"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("mtls")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("detached")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("auth")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("pkey")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/etc/immudb/mtls/3_application/private/localhost.key.pem"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("certificate")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/etc/immudb/mtls/3_application/certs/localhost.cert.pem"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key property"}},[a._v("clientcas")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/etc/immudb/mtls/2_intermediate/certs/ca-chain.cert.pem"')]),a._v("\n")])])]),t("p",[a._v("The important lines to change are "),t("code",[a._v("auth = true")]),a._v(" and "),t("code",[a._v('address = "0.0.0.0"')]),a._v(" to enable authentication and listening on all interfaces.")]),a._v(" "),t("p",[a._v("Then restart/start immudb.")]),a._v(" "),t("h3",{attrs:{id:"get-the-admin-credentials"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-the-admin-credentials"}},[a._v("#")]),a._v(" Get the admin credentials")]),a._v(" "),t("p",[a._v("You need to run "),t("code",[a._v("immuadmin")]),a._v(" locally on the same system as immudb (for security reasons) and connect to immudb:")]),a._v(" "),t("p",[t("code",[a._v("immuadmin login immudb")])]),a._v(" "),t("p",[a._v("You^ll receive the following message:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("Using config file: /etc/immudb/immudb.toml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("\nThis looks like the very first admin login attempt, hence the following credentials have been generated:\n---\nusername: immudb\npassword: immudb\n---\nIMPORTANT: This is the only "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" they are shown, so "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" sure you remember them.\nNOTE: You have not been automatically logged in. To login please run the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'immuadmin login immu'")]),a._v(" with the above-mentioned password. You can change your password at any "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" with one of your liking using the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'immuadmin user change-password immu'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("\n")])])]),t("p",[t("strong",[a._v("Please note that the password for the immudb user is the master password")])]),a._v(" "),t("h3",{attrs:{id:"user-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#user-management"}},[a._v("#")]),a._v(" User management")]),a._v(" "),t("p",[a._v("To manage user, run "),t("code",[a._v("immuadmin user")]),a._v(" after you logged in "),t("code",[a._v("immuadmin login immudb")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("Please specify a user action.\nUsage: immuadmin user list"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("create"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("change-password"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("set-permission"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("deactivate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("read"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("readwrite"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nHelp "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" immuadmin user "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v("\n")])])]),t("h4",{attrs:{id:"list-user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#list-user"}},[a._v("#")]),a._v(" List user")]),a._v(" "),t("p",[a._v("To get a list of all existing user including their permissions, run "),t("code",[a._v("immuadmin user list")])]),a._v(" "),t("h4",{attrs:{id:"add-user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-user"}},[a._v("#")]),a._v(" Add user")]),a._v(" "),t("p",[a._v("Let's create a read-only user, called ro "),t("code",[a._v("immuadmin user create <username> read")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("immuadmin user create ro "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("read")]),a._v("\nNOTE: password must have between "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v(" and "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v(" letters, digits and special characters of "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("which")]),a._v(" at least "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" uppercase letter, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" digit and "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" special character.\nChoose a password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" ro:\nConfirm password:\nUser ro created\n")])])]),t("p",[a._v("and a read-write user, called rw "),t("code",[a._v("immuadmin user create rw readwrite")])]),a._v(" "),t("h4",{attrs:{id:"change-user-permission"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#change-user-permission"}},[a._v("#")]),a._v(" Change user permission")]),a._v(" "),t("p",[a._v("To change the ro user permission from read-only to read-write, run "),t("code",[a._v("immuadmin user set-permission ro readwrite")]),a._v("\nCheck the change, using "),t("code",[a._v("immuadmin user list")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("immuadmin user list\nUsing config file: /etc/immudb/immudb.toml\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(":\n-  --------  ----    -----------\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#  Username  Role    Permissions")]),a._v("\n-  --------  ----    -----------\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("  immu      admin   admin\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("  ro        client  readwrite\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("  rw        client  readwrite\n-  --------  ----    -----------\n")])])]),t("h4",{attrs:{id:"deactivate-user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deactivate-user"}},[a._v("#")]),a._v(" Deactivate user")]),a._v(" "),t("p",[a._v("To deactivate an existing user, run "),t("code",[a._v("immuadmin user deactivate ro")])]),a._v(" "),t("h4",{attrs:{id:"reactivate-user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reactivate-user"}},[a._v("#")]),a._v(" Reactivate user")]),a._v(" "),t("p",[a._v("To reactivate a deactivated user account, you can simply set user permission again. Run "),t("code",[a._v("immuadmin user set-permission ro readwrite")])]),a._v(" "),t("h2",{attrs:{id:"backup-and-restore"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#backup-and-restore"}},[a._v("#")]),a._v(" Backup and Restore")]),a._v(" "),t("p",[a._v("The simplest way to backup immudb is to use your operating system tools like tar or zip.\nYou can stop immudb and backup the data directory (default: "),t("code",[a._v("/var/lib/immudb")]),a._v(") and start immudb again.")]),a._v(" "),t("p",[a._v("The other alternative is using the "),t("code",[a._v("immuadmin backup")]),a._v(" command. Please keep in mind, that "),t("code",[a._v("immuadmin backup")]),a._v(" is stopping immudb as well and a manual start is required.")]),a._v(" "),t("h2",{attrs:{id:"multi-database"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#multi-database"}},[a._v("#")]),a._v(" Multi-Database")]),a._v(" "),t("p",[a._v("Starting immudb version 0.7.0 we introduced a multi-database support. By default the first database is either called defaultdb or based on the environment variable "),t("code",[a._v("IMMUDB_DBNAME")]),a._v(".")]),a._v(" "),t("h3",{attrs:{id:"database-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#database-management"}},[a._v("#")]),a._v(" Database management")]),a._v(" "),t("p",[a._v("We recommend using "),t("code",[a._v("immuadmin")]),a._v(" to create additional users and databases.")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("immuadmin login immudb  # Authentication is enabled by default, default user is immudb and password immudb;\n                        # first login asks for a password change and must contain upper and lower case letters, digits, punctuation mark or symbol\n\nimmuadmin database list          # show all existing databases\nimmuadmin database create testdb # database testdb created\n")])])]),t("p",[a._v("immuclient can be used to test the setup or in scripts. Of course the API supports multi-db handling as well.")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("immuclient login immudb   # login to immudb with user immudb\nimmuclient use testdb     # use testdb for all following commands\nimmuclient safeset k0 v0  # set a key value in testdb\n")])])]),t("h3",{attrs:{id:"database-user-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#database-user-management"}},[a._v("#")]),a._v(" Database user management")]),a._v(" "),t("p",[a._v("You can create additional user using the immuadmin and grant database permissions automatically.")]),a._v(" "),t("p",[t("code",[a._v("immuadmin user help")]),a._v(" shows you all information about the command usage.")]),a._v(" "),t("p",[a._v("Permissions are: "),t("em",[a._v("read")]),a._v(", "),t("em",[a._v("readwrite")]),a._v(" and "),t("em",[a._v("admin")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# create an user for the newly created database\nimmuadmin user create myuser readwrite testdb       # create user myuser (password will be requested) and grant readwrite permissions to testdb\n\nimmuadmin user permission grant myuser admin testdb # change permissions to admin for user myuser on testdb\nimmuadmin user permission grant myuser readwrite testdb # change permissions to readwrite for user myuser on testdb\nimmuadmin user permission revoke myuser readwrite testdb # revoke permissions for user myuser on testdb\n")])])]),t("p",[a._v("To check all database permissions use "),t("code",[a._v("immuadmin user list")])]),a._v(" "),t("h3",{attrs:{id:"api-examples"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api-examples"}},[a._v("#")]),a._v(" API examples")]),a._v(" "),t("p",[a._v("work in progress")]),a._v(" "),t("h2",{attrs:{id:"clients"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clients"}},[a._v("#")]),a._v(" Clients")]),a._v(" "),t("p",[a._v("Starting version 0.6.0 of immudb, you can use immugw (REST API), immuclient (interactive) or GoLang as immudb database clients.\nDepending on the user settings and permissions, you can have read-only and read-write clients.")]),a._v(" "),t("p",[t("RouterLink",{attrs:{to:"/0.8.1/apis-references.html"}},[a._v("APIs and interfaces")]),a._v(" - API reference and code examples")],1),a._v(" "),t("p",[a._v("More driver libraries are coming soon (Java, Node.js, Python, .net aso.)")]),a._v(" "),t("h2",{attrs:{id:"auditors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#auditors"}},[a._v("#")]),a._v(" Auditors")]),a._v(" "),t("p",[a._v("Auditors make sure that the data consistency is guaranteed inside immudb. They do a random key value verification and an interval-based Merkle-tree consistency check (5 minutes default). The immugw and the immuclient provide auditor functionality that runs as a daemon process. It is recommended to run immugw and immuclient on different machines than immudb, so any tampering on the immudb server is automatically detected.")]),a._v(" "),t("p",[a._v("The results of the auditors are provided by a Prometheus end point.")]),a._v(" "),t("h3",{attrs:{id:"immugw-auditor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#immugw-auditor"}},[a._v("#")]),a._v(" immugw auditor")]),a._v(" "),t("p",[a._v("You can find immugw in the following repository: "),t("a",{attrs:{href:"https://github.com/codenotary/immugw",target:"_blank",rel:"noopener noreferrer"}},[a._v("immugw"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("Start interactive:\n"),t("code",[a._v("immugw --audit")])]),a._v(" "),t("p",[a._v("Service configuration:\nTo enable auditor, you need to edit /etc/immudb/immugw.toml and add the following section:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("audit "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# false is default")]),a._v("\naudit-interval "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"5m"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# suffixes: "s", "m", "h", examples: 10s, 5m 1h')]),a._v("\naudit-username "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# when immudb authentication is enabled, use read-only user credentials here")]),a._v("\naudit-password "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# and the password")]),a._v("\n")])])]),t("p",[a._v("Restart the immugw service afterwards - "),t("code",[a._v("immuadmin service immugw restart")])]),a._v(" "),t("p",[t("strong",[a._v("immugw Port: 9476 - http://immugw-auditor:9476/metrics")])]),a._v(" "),t("p",[a._v("example output:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immugw_audit_curr_root_per_server Current root index used for the latest audit.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immugw_audit_curr_root_per_server gauge")]),a._v("\nimmugw_audit_curr_root_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immugw_audit_prev_root_per_server Previous root index used for the latest audit.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immugw_audit_prev_root_per_server gauge")]),a._v("\nimmugw_audit_prev_root_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immugw_audit_result_per_server Latest audit result (1 = ok, 0 = tampered).")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immugw_audit_result_per_server gauge")]),a._v("\nimmugw_audit_result_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immugw_audit_run_at_per_server Timestamp in unix seconds at which latest audit run.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immugw_audit_run_at_per_server gauge")]),a._v("\nimmugw_audit_run_at_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".590757033502689e+09\n")])])]),t("h3",{attrs:{id:"immuclient-auditor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#immuclient-auditor"}},[a._v("#")]),a._v(" immuclient auditor")]),a._v(" "),t("p",[a._v("Start interactive:\n"),t("code",[a._v("immuclient audit-mode")])]),a._v(" "),t("p",[a._v("Install service:\n"),t("code",[a._v("immuclient audit-mode install")])]),a._v(" "),t("p",[a._v("**immuclient Port: 9477 - http://immuclient-auditor:9477/metrics **")]),a._v(" "),t("p",[a._v("example output:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immuclient_audit_curr_root_per_server Current root index used for the latest audit.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immuclient_audit_curr_root_per_server gauge")]),a._v("\nimmuclient_audit_curr_root_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immuclient_audit_prev_root_per_server Previous root index used for the latest audit.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immuclient_audit_prev_root_per_server gauge")]),a._v("\nimmuclient_audit_prev_root_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immuclient_audit_result_per_server Latest audit result (1 = ok, 0 = tampered).")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immuclient_audit_result_per_server gauge")]),a._v("\nimmuclient_audit_result_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# HELP immuclient_audit_run_at_per_server Timestamp in unix seconds at which latest audit run.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# TYPE immuclient_audit_run_at_per_server gauge")]),a._v("\nimmuclient_audit_run_at_per_server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("server_address"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:3322"')]),a._v(",server_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"br8eugq036tfln0ct6o0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".5907565337454605e+09\n")])])]),t("h2",{attrs:{id:"architecture"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#architecture"}},[a._v("#")]),a._v(" Architecture")]),a._v(" "),t("p",[a._v("The different components of immudb are communicating as follows:\n"),t("img",{attrs:{src:"https://github.com/codenotary/immudb-docs/raw/master/src/immudb/component-diagram.png",alt:"immudb component overview"}})]),a._v(" "),t("p",[a._v("Please check How it works, to learn more about the data structure and the Merkle-tree:")]),a._v(" "),t("p",[t("RouterLink",{attrs:{to:"/0.8.1/how-it-works.html"}},[a._v("How it works")])],1),a._v(" "),t("h2",{attrs:{id:"consistency-checker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consistency-checker"}},[a._v("#")]),a._v(" Consistency checker")]),a._v(" "),t("h3",{attrs:{id:"how-do-you-run-it"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-do-you-run-it"}},[a._v("#")]),a._v(" How do you run it?")]),a._v(" "),t("p",[a._v("It is part of immudb, enabled by default and runs as a thread of immudb.\nThe routine can be disabled as follows:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("./immudb --consistency-check"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false\n")])])]),t("h3",{attrs:{id:"what-does-it-check"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-does-it-check"}},[a._v("#")]),a._v(" What does it check?")]),a._v(" "),t("p",[a._v("Consistency checker runs in a loop and continuously checks if the elements stored inside the immudb Merkle-tree are also physically stored correctly on the disk (the digest of the disk elements is the same digest stored in the related Merkle-tree leaf)")]),a._v(" "),t("h3",{attrs:{id:"how-does-it-run-its-check"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-does-it-run-its-check"}},[a._v("#")]),a._v(" How does it run its check?")]),a._v(" "),t("p",[t("strong",[a._v("Steps:")])]),a._v(" "),t("ol",[t("li",[a._v("reading the last root and last index stored in immudb")]),a._v(" "),t("li",[a._v("generate a range between 0 and the length of the Merkle-tree level 0 (total number of elements stored)")]),a._v(" "),t("li",[a._v("shuffles the range to get a random scan list (to be unpredictable)")]),a._v(" "),t("li",[a._v("check if every element is correctly inserted in the Merkle-tree and if the Merkle-tree leaves correctly represent the elements stored on hard disk")]),a._v(" "),t("li",[a._v("after completing the loop, the process sleeps ten seconds and restarts from scratch with a new root and index")]),a._v(" "),t("li",[a._v("in case an element does not pass the check correctly, immudb is immediately stopped and prints out a log message")])]),a._v(" "),t("p",[a._v("In order to produce a corrupted entry that is only on disk and not in the Merkle-tree, stop the immudb process and use the "),t("a",{attrs:{href:"https://github.com/codenotary/immudb/blob/master/tools/nimmu/nimmu.go",target:"_blank",rel:"noopener noreferrer"}},[a._v("nimmu"),t("OutboundLink")],1),a._v(" command:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("go build tools/nimmu/nimmu.go\n./nimmu rawset key1 tamper\n")])])]),t("p",[a._v("Then restart immudb and you should see the consistency check printing an error.")]),a._v(" "),t("h2",{attrs:{id:"license"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#license"}},[a._v("#")]),a._v(" License")]),a._v(" "),t("p",[a._v("immudb is "),t("a",{attrs:{href:"https://github.com/codenotary/immudb/blob/master/LICENSE",target:"_blank",rel:"noopener noreferrer"}},[a._v("Apache v2.0 License"),t("OutboundLink")],1),a._v(".")])])}),[],!1,null,null,null);t.default=r.exports}}]);